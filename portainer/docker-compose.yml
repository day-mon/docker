version: '3.7'

services:
    portainer:
      image: portainer/portainer-ce:latest
      container_name: portainer
      restart: always 
      networks:
        - traefik
      volumes:
        - /etc/localtime:/etc/localtime:ro
        - /var/run/docker.sock:/var/run/docker.sock:ro
        - ./portainer-data:/data
      labels:
        traefik.enable: true
        traefik.http.routers.portainer.entrypoints: https
        traefik.http.services.portainer.loadbalancer.server.port: 9000
        traefik.http.routers.portainer.rule: Host(`docker.$PRIMARY_DOMAIN`)
        traefik.http.routers.portainer.middlewares: authelia@docker



networks:
  traefik:
    external: true
